# governance-periodic-checks.md
## 定期監査・是正運用（常時読み込み対象外）

このファイルは、常時読み込み不要な運用項目をまとめた定期監査用規約である。  
実装時の即時判断は `.github/copilot-instructions.md` を正本とする。

## 1. 一覧系性能の測定基準

- 各一覧画面のテストで、クエリ数予算を明示する。
- 測定条件（データ件数・ページサイズ・フィルタ条件）をテスト内で固定する。
- 主要ケースで実行時間を記録し、前回基準からの退行を監視する。
- 基準変更時は `ai/decision_log.md` に理由・影響・適用日を記録する。

## 2. テスト実行パフォーマンス運用

- ローカル全体実行の既定は並列実行（`manage.py test ... --parallel 4`）とする。
- 反復開発時は変更対象テストを優先実行し、全体回帰は節目（PR前・マージ前）で実施する。
- 遅延調査時は `--durations` を併用し、上位の遅いテストを記録する。
- 重いテストを追加する場合は、軽量化案（分割・共通化・Service単体化）を同時に提示する。
- 実行時間改善施策は、運用コマンドとテスト計画へ反映して再現可能にする。

## 3. 規約例外の詳細管理

規約例外が必要な場合は、実装前に `ai/decision_log.md` へ以下を記録すること。

- 例外理由
- 影響範囲
- 暫定/恒久の別
- 解消方針と期限
- 例外オーナー（担当者/承認者）
- 解消タスクID（`ai/todo.md` 連携）
- 失効日（有効期限）

運用ルール:

- 失効日超過の例外は継続利用不可とし、更新または解消を行う。
- 例外更新時は変更理由と次回失効日を追記する。

## 4. 互換コードの棚卸し

- 互換コードは本番利用者または外部 IF 保護時のみ許可する。
- 互換コードには理由・期限・削除タスクを必ず付与する。
- 四半期ごとに削除可否を見直し、結果を `ai/todo.md` に記録する。

## 5. 定期レビューの実施頻度

- 週次: 変更点の軽量確認（10分）
- 月次: 性能・例外・互換コードの本監査（30〜60分）
- リリース前: 重点監査（必須）

## 6. 用語定義

- テナント境界: 他組織・他利用者のデータに越境アクセスしないための分離境界。
- 正本Service: 当該機能の業務処理・更新処理の唯一の入口となる Service。
- 互換コード: 旧仕様や外部IF保護のために期限付きで残す暫定実装。
- クエリ予算: 一覧系で許容するクエリ数の上限値（テストで固定する目標）。

## 7. 改定履歴

- 2026-02-17: `.github/copilot-instructions.md` から定期監査項目を分離し新設。
