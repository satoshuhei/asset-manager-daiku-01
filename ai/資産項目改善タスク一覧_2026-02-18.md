# 資産項目 改善タスク一覧（優先度付き）

作成日: 2026-02-18  
入力: `ai/資産項目実装精査レポート_2026-02-18.md`

## 1. 目的
- 資産項目の「表示不足」「Web登録/編集不足」を、実装可能な単位へ分解し、優先順で着手できる状態にする。

## 2. 優先順位（MVP順）
1. P1: 資産一覧の表示不足解消（分類/利用者/期限日）
2. P2: 資産一覧の検索条件拡張（資産名/小分類/ステータス/予算紐付け/利用者）
3. P3: 資産詳細の表示拡張（属性20表示）
4. P4: 資産登録Webフォーム実装（API仕様連携）
5. P5: 資産編集Webフォーム実装（API仕様連携 + 状態遷移整合）

## 3. タスク詳細

### P1: 資産一覧の表示不足解消
対象:
- 画面: `templates/account_requests/asset_list.html`
- View: `apps/account_requests/web_views.py`

対応内容:
- 一覧列へ以下を追加
  - 分類（大/中/小）
  - 利用者（`person_attr_01`）
  - 期限日（`date_attr_03`）
- `select_related/prefetch_related` を用いてN+1を回避

完了条件:
- SCR-010 の `AS-L-003/006/007` が表示される
- 一覧系性能テスト予算を超過しない

---

### P2: 資産一覧の検索条件拡張
対象:
- 画面: `templates/account_requests/asset_list.html`
- View: `apps/account_requests/web_views.py`

対応内容:
- 検索条件に `AS-S-002〜006` を追加
  - 資産名（部分一致）
  - 小分類
  - ステータス
  - 予算紐付け状態
  - 利用者
- 検索条件の保持表示を実装

完了条件:
- SCR-010 の `AS-S-001〜006` が全て利用可能
- 正常系/異常系（不正パラメータ）をテストで確認

---

### P3: 資産詳細の表示拡張
対象:
- 画面: `templates/account_requests/asset_detail.html`
- View: `apps/account_requests/web_views.py`

対応内容:
- 基本情報に分類階層を追加表示
- 属性20（`AS-A-001〜020`）を表示セクションとして追加
- 1:n属性（`multi_attr_01/02`）を複数行表示

完了条件:
- SCR-011 の表示要件が確認できる
- 主要表示項目に欠落がない

---

### P4: 資産登録Webフォーム実装
対象:
- 画面: `templates/account_requests/asset_list.html`（または専用作成画面）
- View: `apps/account_requests/web_views.py`
- Service連携: `apps/account_requests/services/asset_service.py`

対応内容:
- 資産登録フォームで基本情報 + 属性20 + 1:n入力を受け付け
- バリデーションエラー表示を画面に反映
- `create_asset` の業務制約（PC利用者必須等）をそのまま活用

完了条件:
- Web経由で新規資産登録が可能
- APIと同等の入力制約で失敗/成功が再現される

---

### P5: 資産編集Webフォーム実装
対象:
- 画面: `templates/account_requests/asset_detail.html`
- View: `apps/account_requests/web_views.py`
- Service連携: `apps/account_requests/services/asset_service.py`, `workflow_service.py`

対応内容:
- 編集フォームで基本情報 + 属性20 + 1:n更新
- ステータス変更は遷移マスタ制約に従う
- 更新結果を監査ログで追跡可能にする

完了条件:
- Web経由で編集更新が可能
- 不正遷移は拒否され、画面エラー表示される

## 4. テスト追加方針
- WebInterfaceTests を中心に追加
  - 一覧表示列検証
  - 検索条件ごとの絞り込み検証
  - 詳細表示（属性20/1:n）検証
  - 登録/編集の正常系・異常系
- 既存の性能テスト方針（`--durations`）を維持

## 5. 実行順提案（短期）
- Sprint 1: P1 + P2
- Sprint 2: P3
- Sprint 3: P4
- Sprint 4: P5
