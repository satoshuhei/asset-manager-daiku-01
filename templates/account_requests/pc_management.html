{% extends "account_requests/base.html" %}
{% block title %}PC管理{% endblock %}
{% block content %}
<h1 class="h3 mb-3">PC管理</h1>
{% if error_message %}<div class="alert alert-danger py-2">{{ error_message }}</div>{% endif %}

<div class="card shadow-sm border-0 mb-4">
    <div class="card-header bg-white"><strong>PC割当登録</strong></div>
    <div class="card-body">
        <form method="post" class="row g-3 align-items-end">
            {% csrf_token %}
            <div class="col-md-5">
                <label class="form-label">PC資産</label>
                <select class="form-select" name="asset_id" required>
                    {% for asset in pc_assets %}
                    <option value="{{ asset.id }}">{{ asset.asset_code }} / {{ asset.asset_name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="col-md-2"><label class="form-label">利用者ID</label><input class="form-control" type="number" name="user_id" required></div>
            <div class="col-md-2"><label class="form-label">OS</label><input class="form-control" type="text" name="os_name" required></div>
            <div class="col-md-2"><label class="form-label">保証期限</label><input class="form-control" type="date" name="warranty_expiry_date"></div>
            <div class="col-md-1 text-end"><button class="btn btn-primary" type="submit">登録</button></div>
            <div class="col-12"><label class="form-label">スペック</label><input class="form-control" type="text" name="spec_text"></div>
        </form>
    </div>
</div>

<div class="card shadow-sm border-0">
    <div class="card-header bg-white"><strong>PC割当一覧</strong></div>
    <div class="table-responsive">
        <table class="table table-striped table-hover mb-0 align-middle">
            <thead class="table-light"><tr><th>ID</th><th>資産コード</th><th>利用者ID</th><th>OS</th><th>スペック</th><th>保証期限</th></tr></thead>
            <tbody>
            {% for item in assignments %}
                <tr>
                    <td>{{ item.id }}</td>
                    <td>{{ item.asset.asset_code }}</td>
                    <td>{{ item.user_id }}</td>
                    <td>{{ item.os_name }}</td>
                    <td>{{ item.spec_text }}</td>
                    <td>{{ item.warranty_expiry_date }}</td>
                </tr>
            {% empty %}
                <tr><td colspan="6" class="text-center text-muted py-4">データがありません</td></tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}
