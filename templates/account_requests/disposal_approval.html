{% extends "account_requests/base.html" %}
{% block title %}廃棄承認{% endblock %}
{% block content %}
<h1 class="h3 mb-3">廃棄承認待ち一覧</h1>
{% if error_message %}<div class="alert alert-danger py-2">{{ error_message }}</div>{% endif %}

<div class="card shadow-sm border-0">
    <div class="card-header bg-white"><strong>承認待ちデータ</strong></div>
    <div class="table-responsive">
        <table class="table table-striped table-hover mb-0 align-middle">
            <thead class="table-light">
                <tr>
                    <th>ID</th>
                    <th>資産ID</th>
                    <th>申請者</th>
                    <th>申請日時</th>
                    <th>状態</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                {% for disposal in disposals %}
                <tr>
                    <td>{{ disposal.id }}</td>
                    <td>{{ disposal.asset_id }}</td>
                    <td>{{ disposal.requested_by_id }}</td>
                    <td>{{ disposal.requested_at }}</td>
                    <td>{{ disposal.disposal_status }}</td>
                    <td>
                        <form method="post" class="d-flex gap-2 mb-2">
                            {% csrf_token %}
                            <input type="hidden" name="action" value="approve">
                            <input type="hidden" name="disposal_id" value="{{ disposal.id }}">
                            <input class="form-control form-control-sm" type="text" name="evidence_text" placeholder="証跡内容" required>
                            <button class="btn btn-sm btn-primary" type="submit">承認</button>
                        </form>
                        <form method="post" class="d-flex gap-2">
                            {% csrf_token %}
                            <input type="hidden" name="action" value="reject">
                            <input type="hidden" name="disposal_id" value="{{ disposal.id }}">
                            <input class="form-control form-control-sm" type="text" name="reason" placeholder="差戻し理由" required>
                            <button class="btn btn-sm btn-outline-danger" type="submit">差戻し</button>
                        </form>
                    </td>
                </tr>
                {% empty %}
                <tr><td colspan="6" class="text-center text-muted py-4">承認待ちはありません</td></tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endblock %}